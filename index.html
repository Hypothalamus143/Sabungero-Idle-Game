<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sabungero Idle Game</title>
    <link rel="manifest" href="/manifest.json">
    <script>
    alert();
    if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js', { scope: './' })
        .then(registration => {
            console.log('‚úÖ SW registered successfully:', registration);
            // Refresh the page to activate it
        });
}
    </script>
    <script>
        // Initialize File System API immediately in HTML
        let fileSystemRoot = null;

        async function initializeFileSystem() {
            try {
                if (navigator.storage) {
                    fileSystemRoot = await navigator.storage.getDirectory();
                    console.log('‚úÖ File System API initialized in HTML');
                }
            } catch (error) {
                console.error('‚ùå File System init failed:', error);
            }
        }

        // Start initialization immediately
        initializeFileSystem();
    </script>
    <script src="js/core/AssetManager.js"></script>
    <script src="js/utils/pixi.js"></script>
    <script src="js/utils/mammoth.browser.min.js"></script>
    <script src="js/utils/pdf.min.js"></script>
    <script src="js/utils/howler.min.js"></script>
    <link rel="stylesheet" type="text/css" href="styles/style.css">
    <link rel="stylesheet" type="text/css" href="styles/avatarCreation.css">

    <!--PIXEL FONT-->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="styles/tutorial.css">
    <link rel="stylesheet" type="text/css" href="styles/battlePanel.css">
    <link rel="stylesheet" type="text/css" href="styles/learningPanel.css">
    <link rel="stylesheet" type="text/css" href="styles/quests/reading.css">
    <link rel="stylesheet" type="text/css" href="styles/quests/flashcard.css">
    <link rel="stylesheet" type="text/css" href="styles/quests/quiz.css">

</head>
<!-- Simple Control Panel -->
<div id="control-panel" style="position: fixed; top: 10px; left: 10px; z-index: 10000; background: rgba(0,0,0,0.9); padding: 10px; border-radius: 8px; border: 2px solid #ffb94f;">
    <button onclick="assetManager.downloadAllAssets()" style="display: block; margin: 5px 0; padding: 8px 12px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; font-family: 'Press Start 2P', monospace; font-size: 10px;">üì• Download Latest Assets</button>
    <button onclick="assetManager.clearAllAssets()" style="display: block; margin: 5px 0; padding: 8px 12px; background: #ff4444; color: white; border: none; border-radius: 5px; cursor: pointer; font-family: 'Press Start 2P', monospace; font-size: 10px;">üóëÔ∏è Clear Assets</button>
    <button onclick="assetManager.installPWA()" style="display: block; margin: 5px 0; padding: 8px 12px; background: #2196F3; color: white; border: none; border-radius: 5px; cursor: pointer; font-family: 'Press Start 2P', monospace; font-size: 10px;">üì± Install App</button>
</div>
<body>

    <!--NEW!!!: UI CHANGES: added invisible container for responsiveness (ata T.T)-->

    <!--NAVBAR CHANGES:
        - capslock ra ang
        -->

<div id="loading-screen" class="loading-screen">
    <div class="loading-content">
        <h2>Sabungero Idle Game</h2>
        <div class="spinner"></div>
        <div class="loading-text">Loading Game Assets...</div>
    </div>
</div>

<div id="game-container" style="display: flex;"></div>
    <div id="ui-overlay">
        <div class="navbar">
            <button id="nav-main" class="nav-btn active">üè† PUGARAN</button>
            <button id="nav-quests" class="nav-btn">üìö SKWELAHAN</button>
            <button id="nav-arena" class="nav-btn">‚öîÔ∏è SABUNGAN</button>
        </div>

        <div class="invisible-container">


            <!--STATS PANEL CHANGES:
            - font color change
            - made stats-content class
            - added classes yellow, white for background
            -->
            <!-- Stats Panel -->

            <div class="panel stats-panel">

                <div class="yellow">
                    <div class="white">

                        <h3>SABUNGERO STATS</h3>
                        <div id="stats-content" class="stats-content">
                            <p>Level: <span id="player-level">1</span></p>
                            <p>Multiplier: <span id="player-multiplier">1.0</span>x</p>
                            <p>Experience: <span id="player-exp">0</span>/<span id="exp-needed">100</span></p>
                            <div class="progress-bar">
                                <div id="exp-bar" class="progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        <!--CHANGES:
               NEW - capslocked words
               NEW - added yellow and white classes
               NEW - added learning-panel-content-container
               NEW - 
            -->

            <!-- Learning Panel -->

            <div class="panel learning-panel">
                <div class="yellow">
                    <div class="white">
                        <div id="blur"></div>
                        <div class="learning-panel-header" >

                            <h3>LEARNING QUESTS</h3>
                            <div class="content-tabs">
                                <button id="tab-reading" class="tab-btn">üìñ READING</button>
                                <button id="tab-flashcards" class="tab-btn">üé¥ FLASHCARDS</button>
                                <button id="tab-quiz" class="tab-btn">‚ùì QUIZ</button>
                            </div>

                            <div id="search-generate">
                                <input type="text" id="topic-search" placeholder="Search topics...">
                            </div>

                        </div>


                        <div class="learning-panel-content-container">
                            <div class="learning-panel-content">
                                <div id="search-results" style="display: none;">
                                    </br>
                                    <h4>Search Results for <span id="current-content-type">All</span>:</h4>
                                   
                                    <div id="results-container"></div>
                                </div>
                            </div>
                            </div>
                        
    
                            <!-- Fixed Bottom Section -->
                            <div class="learning-panel-bottom">
                                <!-- Pagination container -->
                                <div id="bottom-pagination" style="visibility: hidden; height: 10%"></div>
                                <div id="ai-suggestion">
                                    <p>WANT SOMETHING ELSE? <button id="generate-similar">‚ú® Generate with AI</button></p>
                                </div>
                            </div>
                        </div>
                    </div>
            </div>


            <!--
                
                CHANGES: ALOT (LOST TRACK) BETTER IF I COPY PASTE NALANG HUHU SRRY
                Battle Panel -->
                <div class="panel battle-panel">

                    <div class="yellow">
                        <div class="white">
                            <h3>BATTLE STATS</h3>
                            <div id="battle-hp">
    
    
                                <div class="hp-bar">
                                    <label>Your HP:</label>
                                    <div class="progress-bar">
                                        <div id="player-hp-bar" class="progress-fill" style="width: 100%"></div>
                                        <div class="lines">
                                        </div>
                                    </div>
                                    <span id="player-hp-text">100/100</span>
                                </div>
    
    
                                <div class="hp-bar">
                                    <label>
                                        <p>Opponent: <span id="opponent-name">None</span></p>
                                    </label>
    
                                    <div class="progress-bar">
                                        <div id="opponent-hp-bar" class="progress-fill" style="width: 100%"></div>
                                        <div class="lines">
                                        </div>
                                    </div>
                                    <span id="opponent-hp-text">100/100</span>
                                </div>
    
    
                            </div>
                            <div class="just-this-container">
                                <p>Hold keys to power up your rooster!</p>
    
                                <div id="key-indicators">
                                    <div class="key-count">
                                        Keys Pressed: <span id="active-keys-count">0</span>
                                    </div>
                                </div>
                            </div>
    
                            <div class="battle-info-white">
    
                                <div id="battle-info">
    
    
                                    <div id="battle-result"></div>
                                    <div class="battle-buttons">
                                   <button id="battle-btn">‚öîÔ∏è Find Opponent</button> <button id="fight-btn" style="display: none;">ü•ä Fight!</button> 
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


            <!-- CHANGES FOR AI OPTIONS MODAL
                   
                 NEW - added yellow class
                 NEW - changed letter casing
                 NEW - removed some emojis

                -->
            <!-- AI Options Modal -->
            <div id="ai-options-modal" class="modal" style="display: none;">
                <div class="ai-options-content">
                    <div class="yellow">
                        <button id="close-ai-options" class="close-btn">‚úñ</button>
                        <div class="ai-name-container">
                            <h2>AI TOOLS & SETTINGS</h2>
                        </div>
                        <!-- API Key Section -->
                        <div class="option-section">
                            <label for="api-key-input-modal"> Gemini API Key</label>
                            <input type="password" id="api-key-input-modal" placeholder="Enter your Gemini API key">
                            <button id="save-api-key-modal">Save Key</button>
                        </div>

                        <!-- Generate Content -->
                        <div class="option-section">
                            <label>Generate AI Content</label>
                            <button id="generate-ai-now">Generate with AI</button>
                        </div>

                        <!-- File Upload (for future use) -->
                        <div class="option-section">
                            <label>Add Source File (Optional)</label>
                            <input type="file" id="file-input" accept=".txt,.pdf,.docx">
                            <p class="note">Supported: TXT, PDF, DOCX</p>
                        </div>
                    </div>
                </div>
            </div>


        <!-- CHANGES FOR QUEST MODAL
             NEW - added yellow,white class
             NEW - changed close -> x in <button id="close-quset">
            -->
            <!-- Quest Modal -->

            <div class="panel quest-modal" id="quest-modal">
                <div class="yellow">
                    <div class="white">
                        <div id="quest-content"></div>
                        <button id="close-quest">X</button>
                        <button id="submit-quest" style="display: none;">Submit Answers</button>
                    </div>
                </div>
            </div>
        </div> <!--invisible container-->
    </div>
    

    <!--CHANGES FOR CREATEAVATAR:
        - added class: yellow, white (for background)
        - made individual class for rooster (creation-section-rooster), and accessory section(creation-section-accessory) but still in one class <creation-section>
    NEW - wrapped combined-preview-section and creation-section in "showcase" so it'll flexbox, makes the site a bit responsive
            -->
    <div id="avatar-creation-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="avatar-creation">

                <div class="yellow">
                    <div class="white">


                        <h2>CREATE YOUR ROOSTER!</h2>

                        <div class="showcase">

                            <div class="combined-preview-section">

                                <!--<h3>Your Rooster</h3>-->
                                <div id="combined-preview-circle" class="combined-preview-circle canvas-stack"></div>
                                <div class="preview-names">
                                    <div id="main-color-name">Red</div>
                                    <div id="border-color-name">Crownr</div>

                                </div>

                            </div>



                            <!-- Main Color Selection -->
                            <div class="creation-section">
                                <div class="creation-section-rooster">
                                    <h3>Rooster</h3>
                                    <div class="carousel">
                                        <button class="carousel-btn left-btn">‚óÄ</button>
                                        <div id="main-display"class="color-display main-display"></div>
                                        <button class="carousel-btn right-btn">‚ñ∂</button>
                                    </div>
                                </div>

                                <div class="creation-section-accessory">
                                    <h3>Accessory</h3>
                                    <div class="carousel">
                                        <button class="carousel-btn left-btn">‚óÄ</button>
                                        <div id="border-display" class="color-display border-display"></div>
                                        <button class="carousel-btn right-btn">‚ñ∂</button>
                                    </div>
                                </div>
                            </div>

                        </div>


                        <button id="confirm-avatar" class="confirm-btn">START YOUR JOURNEY!</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>


    <!--CHANGES FOR TUTORIAL:
    - changed class: confirm-btn -> confirm-btn-tutorial
    - removed emojis sa <p>-->

    <div id="tutorial-modal" class="modal" style="display: none;">
        <div class="modal-content tutorial-content" id="tutorial-content">
            <div class="tutorial" id="tutorial">
                <h2>WELCOME TO SABUNGERO IDLE GAME!</h2>
                <div class="tutorial-step">
                    <h3> YOUR MISSION</h3>
                    <hr />
                    <p>‚ñ∂ Become the ultimate Sabungero by learning and battling!</p>
                </div>

                <div class="tutorial-step">
                    <h3> LEARN & GROW</h3>
                    <hr />
                    <p>‚ñ∂ Use AI to generate new learning content!</p>
                    <p>‚ñ∂ <strong>Reading</strong> - Study educational articles</p>
                    <p>‚ñ∂ <strong>Flashcards</strong> - Quick Q&A practice</p>
                    <p>‚ñ∂ <strong>Quizzes</strong> - Test your knowledge</p>

                </div>

                <div class="tutorial-step">
                    <h3>  BATTLE OPPONENTS</h3>
                    <hr />
                    <p>‚ñ∂ Higher ranks = tougher opponents</p>
                    <p>‚ñ∂ Gain MMR and climb the ranks</p>
                    <p>‚ñ∂ Fight AI roosters in the Arena</p>

                </div>

                <div class="tutorial-step">
                    <h3>  IDLE PROGRESSION</h3>
                    <hr />
                    <p>‚ñ∂ Hold as many keys to gain as much experience</p>
                    <p>‚ñ∂ Become an Educated Sabungero</p>
                    <p>‚ñ∂ Defeat Stronger Enemies!</p>
                    <p>‚ñ∂ Unlock better multipliers</p>

                </div>

                <div class="tutorial-step">
                    <h3> RANKS</h3>
                    <hr />
                    <p>Novice ‚Üí Bronze ‚Üí Silver ‚Üí Gold ‚Üí Platinum ‚Üí Diamond ‚Üí Master ‚Üí Grand Sabungero</p>
                </div>

                <button id="start-playing" class="confirm-btn-tutorial">Start Playing! </button>

            </div>

        </div>
    </div>





    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>
    <script>
        window.addEventListener('load', async () => {
            window.app = new PIXI.Application();
            await window.app.init({
                width: 1920,        // Match your container
                height: 1080,
                antialias: true
            });
            window.stageContainer = window.app.stage;
            document.getElementById("file-input").value = "";
        });
    </script>
    <script src="js/systems/UISystem/Roosters.js"></script>
    <script src="js/systems/UISystem/UISystem.js"></script>
    <script src="js/core/config.js"></script>
    <script src="js/systems/BattleSystem/BattleEngine.js"></script>
    <script src="js/systems/BattleSystem/BattleAnimationManager.js"></script>
    <script src="js/systems/BattleSystem/BattleSystem.js"></script>
    <script src="js/systems/LearningSystem/ReadingManager.js"></script>
    <script src="js/systems/LearningSystem/FlashcardsManager.js"></script>
    <script src="js/systems/LearningSystem/QuizManager.js"></script>
    <script src="js/core/DefaultContent.js"></script>
    <script src="js/systems/LearningSystem/AIGenerated.js"></script>
    <script src="js/systems/LearningSystem/ContentSearch.js"></script>
    <script src="js/systems/LearningSystem/LearningSystem.js"></script>
    <script src="js/systems/IdleSystem/Hearts.js"></script>
    <script src="js/systems/IdleSystem/IdleSystem.js"></script>
    <script src="js/core/BrowserDB.js"></script>
    <script src="js/systems/UISystem/ScaleToFit.js"></script>
    <script src="js/core/game.js"></script>
</body>
</html>

